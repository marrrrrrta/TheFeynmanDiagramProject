\documentclass{article}
\usepackage{tikz}
\usepackage{physics}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{arrows.meta}

\begin{document}

\begin{tikzpicture}[
  fermion/.style={draw=black, postaction={decorate}, decoration={markings,mark=at position .55 with {\arrow[black]{>}}}},
  antifermion/.style={draw=black, postaction={decorate}, decoration={markings,mark=at position .55 with {\arrow[black]{<}}}},
  photon/.style={decorate, decoration={snake}, draw=black},
  gluon/.style={decorate, decoration={coil, amplitude=4pt, segment length=5pt}, draw=black},
  weak/.style={decorate, decoration={snake, amplitude=1pt}, draw=black},
  time axis/.style={->, thick, draw=black, dashed}
]

% Time axis
\draw[time axis] (-1,-2) -- (10,-2) node[right] {$t$};

%% SPECTATOR PARTICLES
% Spectator particles (straight horizontal lines at the top)
{% for particle in spectators['initial'] %}
  \coordinate (p{{ loop.index }}_in) at (0,{{ 6 - loop.index }});
  \coordinate (p{{ loop.index }}_out) at (10,{{ 6 - loop.index }});
  \draw[fermion] (p{{ loop.index }}_in) -- (p{{ loop.index }}_out) node[right] {${{ particle }}$};
  \node[left] at (p{{ loop.index }}_in) {${{ particle }}$};
{% endfor %}

% Position counter for interactions (starts below spectators)
{% set y_pos = 3 %}

%% FLAVOR CHANGING INTERACTIONS
{% if interactions['flavor_change']['quark_pairs'] or interactions['flavor_change']['lepton_pairs'] %}
  {% set y_pos = y_pos - 1.5 %}
  
  % Quark flavor changes
  {% for pair in interactions['flavor_change']['quark_pairs'] %}
    \coordinate (fq_in{{ loop.index }}) at (2,{{ y_pos }});
    \coordinate (fq_out{{ loop.index }}) at (8,{{ y_pos }});
    \coordinate (fq_mid{{ loop.index }}) at (5,{{ y_pos }});
    \coordinate (fq_exchange{{ loop.index }}) at (5,{{ y_pos + 0.8 }});
    
    \draw[fermion] (fq_in{{ loop.index }}) -- (fq_mid{{ loop.index }});
    \draw[fermion] (fq_mid{{ loop.index }}) -- (fq_out{{ loop.index }});
    \draw[weak] (fq_mid{{ loop.index }}) -- (fq_exchange{{ loop.index }}) node[above] {${{ symbols['flavor_change'] }}$};
    
    \node[left] at (fq_in{{ loop.index }}) {${{ pair[0] }}$};
    \node[right] at (fq_out{{ loop.index }}) {${{ pair[1] }}$};
    
    {% set y_pos = y_pos - 1 %}
  {% endfor %}
  
  % Lepton flavor changes
  {% for pair in interactions['flavor_change']['lepton_pairs'] %}
    \coordinate (fl_in{{ loop.index }}) at (2,{{ y_pos }});
    \coordinate (fl_out{{ loop.index }}) at (8,{{ y_pos }});
    \coordinate (fl_mid{{ loop.index }}) at (5,{{ y_pos }});
    \coordinate (fl_exchange{{ loop.index }}) at (5,{{ y_pos + 0.8 }});
    
    \draw[fermion] (fl_in{{ loop.index }}) -- (fl_mid{{ loop.index }});
    \draw[fermion] (fl_mid{{ loop.index }}) -- (fl_out{{ loop.index }});
    \draw[weak] (fl_mid{{ loop.index }}) -- (fl_exchange{{ loop.index }}) node[above] {${{ symbols['flavor_change'] }}$};
    
    \node[left] at (fl_in{{ loop.index }}) {${{ pair[0] }}$};
    \node[right] at (fl_out{{ loop.index }}) {${{ pair[1] }}$};
    
    {% set y_pos = y_pos - 1 %}
  {% endfor %}
{% endif %}

%% STRONG INTERACTIONS
{% if interactions['strong']['quark_pairs'] %}
  {% set y_pos = y_pos - 1.5 %}
  
  {% for pair in interactions['strong']['quark_pairs'] %}
    \coordinate (s_in{{ loop.index }}) at (2,{{ y_pos }});
    \coordinate (s_out{{ loop.index }}) at (8,{{ y_pos }});
    \coordinate (s_mid{{ loop.index }}) at (5,{{ y_pos }});
    \coordinate (s_vertex{{ loop.index }}) at (5,{{ y_pos - 0.8 }});
    
    \draw[fermion] (s_in{{ loop.index }}) -- (s_mid{{ loop.index }});
    \draw[antifermion] (s_out{{ loop.index }}) -- (s_mid{{ loop.index }});
    \draw[gluon] (s_mid{{ loop.index }}) -- (s_vertex{{ loop.index }}) node[below] {${{ symbols['strong'] }}$};
    
    \node[left] at (s_in{{ loop.index }}) {${{ pair[0] }}$};
    \node[right] at (s_out{{ loop.index }}) {${{ pair[1] }}$};
    
    {% set y_pos = y_pos - 1 %}
  {% endfor %}
{% endif %}

%% EM INTERACTIONS
{% if interactions['em']['initial_pairs'] or interactions['em']['final_pairs'] %}
  {% set y_pos = y_pos - 1.5 %}
  
  % Initial EM pairs
  {% for pair in interactions['em']['initial_pairs'] %}
    \coordinate (em_i1{{ loop.index }}) at (2,{{ y_pos }});
    \coordinate (em_i2{{ loop.index }}) at (2,{{ y_pos - 0.8 }});
    \coordinate (em_mid{{ loop.index }}) at (5,{{ y_pos - 0.4 }});
    
    \draw[fermion] (em_i1{{ loop.index }}) -- (em_mid{{ loop.index }});
    \draw[antifermion] (em_i2{{ loop.index }}) -- (em_mid{{ loop.index }});
    \draw[photon] (em_mid{{ loop.index }}) -- (8,{{ y_pos - 0.4 }}) node[right] {${{ symbols['em'] }}$};
    
    \node[left] at (em_i1{{ loop.index }}) {${{ pair[0] }}$};
    \node[left] at (em_i2{{ loop.index }}) {${{ pair[1] }}$};
    
    {% set y_pos = y_pos - 1.2 %}
  {% endfor %}
  
  % Final EM pairs
  {% for pair in interactions['em']['final_pairs'] %}
    \coordinate (em_f{{ loop.index }}) at (5,{{ y_pos - 0.4 }});
    \coordinate (em_o1{{ loop.index }}) at (8,{{ y_pos }});
    \coordinate (em_o2{{ loop.index }}) at (8,{{ y_pos - 0.8 }});
    
    \draw[photon] (2,{{ y_pos - 0.4 }}) -- (em_f{{ loop.index }}) node[left] {${{ symbols['em'] }}$};
    \draw[fermion] (em_f{{ loop.index }}) -- (em_o1{{ loop.index }});
    \draw[antifermion] (em_f{{ loop.index }}) -- (em_o2{{ loop.index }});
    
    \node[right] at (em_o1{{ loop.index }}) {${{ pair[0] }}$};
    \node[right] at (em_o2{{ loop.index }}) {${{ pair[1] }}$};
    
    {% set y_pos = y_pos - 1.2 %}
  {% endfor %}
{% endif %}

%% WEAK INTERACTIONS
{% if interactions['weak']['pairs'] %}
  {% set y_pos = y_pos - 1.5 %}
  
  {% for pair in interactions['weak']['pairs'] %}
    \coordinate (w_in{{ loop.index }}) at (2,{{ y_pos }});
    \coordinate (w_out{{ loop.index }}) at (8,{{ y_pos }});
    \coordinate (w_mid{{ loop.index }}) at (5,{{ y_pos }});
    
    \draw[fermion] (w_in{{ loop.index }}) -- (w_mid{{ loop.index }});
    \draw[fermion] (w_mid{{ loop.index }}) -- (w_out{{ loop.index }});
    \draw[weak] (w_mid{{ loop.index }}) -- (5,{{ y_pos - 0.8 }}) node[below] {${{ symbols['weak'] }}$};
    
    \node[left] at (w_in{{ loop.index }}) {${{ pair[0] }}$};
    \node[right] at (w_out{{ loop.index }}) {${{ pair[1] }}$};
    
    {% set y_pos = y_pos - 1 %}
  {% endfor %}
{% endif %}

\end{tikzpicture}

\end{document}